#!/bin/bash
# CI/CD Performance Regression Check Script
# Automatically generated by RusTorch Performance Regression Detector

set -e

echo "ğŸ” Running performance regression check..."

# Run benchmark and capture results
cargo run --example performance_regression_detector --features "metal coreml" --release > regression_results.log 2>&1

# Check for critical alerts
if grep -q "ğŸš¨\|ğŸ”´" regression_results.log; then
    echo "âŒ CRITICAL PERFORMANCE REGRESSION DETECTED!"
    echo "ğŸ“‹ Alert Summary:"
    grep -E "ğŸš¨|ğŸ”´" regression_results.log
    echo ""
    echo "ğŸ”§ Recommended Actions:"
    echo "  1. Review recent changes"
    echo "  2. Check system resources"
    echo "  3. Consider rolling back"
    echo ""
    exit 1
elif grep -q "ğŸŸ¡" regression_results.log; then
    echo "âš ï¸  Performance warnings detected - monitoring required"
    grep "ğŸŸ¡" regression_results.log
    exit 0
else
    echo "âœ… No performance regressions detected"
    exit 0
fi
